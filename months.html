<!--***************************************************************************************
Distribution of this tool or file to any external party is not permitted.
All information and formulas in this tool are strictly confidential. 
Only screenshots (screen captured image) of calculation results can be shared externally. 
All rights reserved. Copyright Â© 2017 Richard Inniss
****************************************************************************************-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title class="title">Monthly Page</title>
  <link rel="stylesheet" href="styles/style.css" />
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
</head>
<body onload="calculate()">
  <h1>DMB ROI CALCULATOR </h1>
  <h2>Months vs Average Check Lift Scenario</h2>
<div class="tab">
  <button class="tab_on" id="tab1">Calculator (Month)</button>
  <button class="tab_off" id="tab2">Calculator (Margin)</button>
  <button class="tab_off" id="tab3">Pricing Data</button>
</div>
<table class="tg">
  <tr>
    <td class="logo" rowspan="2"><img src="images/AIoT_Logo6.png" alt="" style="width: 150px;"></td>
    <td class="month_header" colspan="5">AVERAGE STORE ESTIMATES</td>
  <tr>
    <td class="left_border"></td>
    <td class="item"></td>
    <td class="month_header" colspan="2" style="height: 35px;">TRANSACTIONS</td>
    <td class="item"></td>
  </tr>
  <tr>
    <td class="item" rowspan="2">
      <legend for="months">MONTHS VS AVERAGE CHECK</legend>
      <input type="number" id="months" name="months" min="1" max="120" value="36"></div> </td>
    <td class="item" rowspan="2">
      <legend for="revenue">ANNUAL<br>STORE REVENUE</legend>
      <input type="text" id="revenue" name="revenue" min="1" max="100,000,000" value="100000"></td>
    <td class="item" rowspan="2">
      <legend for="avgchk">AVERAGE<br>STORE CHECK</legend>
      <input type="text" id="avgchk" name="avgchk" min="1" max="10,000" value="10.00"></td>
    <td class="weekly">
      <legend for="weekly">WEEKLY</legend>
      <span id="weekly">...</span>
    </td>
    <td class="monthly">
      <legend for="monthly">MONTHLY</legend>
      <span id="monthly">...</span>
    </td>
    <td class="item" rowspan="2">
      <legend for="margin">AVERAGE<br>PRODUCT MARGIN</legend>
      <input type="text" id="margin" name="margin" min="1" max="100" value="50.00"></td>
  </tr>

  <tr>
    <td class="transac" colspan="2">NUMBER OF TRANSACTIONS OVER PERIOD:   <span id="totalTrans">...</span></td>
  </tr>
  <tr>
    <td class="subtle_4" colspan="2">STORE OPERATING CONDITIONS<br> AS SELECTED ON PRICING DATA TAB</td>

    <td class="subtle_4">COSTS</td>
    <td class="subtle_5" colspan="2">REQUIRED CHECK LIFT PER<br>TRANSACTION OVER PERIOD</td>
    <td class="profit" rowspan="2"><div>Profit Store is Loosing Over<br><span id="period">...</span> Year Equipment Lifspan</div></td>
  </tr>
  <tr>
    <td class="opertitles">Number of Displays:</td>
    <td class="operspan"><span id="screens">...</span></td>
    <td class="item">
      <div class="item_in_left">Up-Front:</div>
      <div class="item_in_right" id="capex_tot"></div>
    </td>
    <td class="item" rowspan="3"><div id="checkD"></div></td>
    <td class="item" rowspan="3"><div id="checkP"></div></td>

  </tr>
    <tr>
    
    <td class="opertitles">Number of Days Opens: </td>
    <td class="operspan"><span id="days">...</span></td>
    <td class="item">
      <div class="item_in_left">Monthly Operating:</div>
      <div class="item_in_right" id="monthly_tot"></div>
    </td>
    
    
    <td class="profit" rowspan="2"><div class="profitnum" id="profit"></div></td>
  </tr>
    <tr>
    
    <td class="opertitles">Number of Hours Open: </td>
    <td class="operspan"><span id="hours">...</span></td>
    <td class="item">
      <div class="item_in_left">Monthly Electrical:</div>
      <div class="item_in_right" id="ele_tot"></div>
    </td>
 
  </tr>
</table>
<script>

document.getElementById("tab2").addEventListener("click",() =>  {
    window.open("margin.html", "_self");
});
document.getElementById("tab3").addEventListener("click",() =>  {
    window.open("pricing.html", "_self");
});


/*** Update values upon page load or value change ***/
let annualSalesMth = localStorage.getItem('adSales_mth') || 0;
let lifeSpanMth = localStorage.getItem('life_num') || 7;
let annualElec = localStorage.getItem('ele_tot') || 0;
let annualOper = localStorage.getItem('mothly_tot') || 0;

months.value = localStorage.getItem('months_num') || 36;
document.getElementById("months").addEventListener("click",() =>  {
  localStorage.setItem('months_num', months.value);
  calculate();});

revenue.value = localStorage.getItem('revenue_num') || 0;
document.getElementById("revenue").addEventListener("input",() =>  {
  localStorage.setItem('revenue_num', revenue.value);
  calculate();});

avgchk.value = localStorage.getItem('avgchk_num') || 0;
document.getElementById("avgchk").addEventListener("input",() =>  {
  localStorage.setItem('avgchk_num', avgchk.value);
  calculate();});

margin.value = localStorage.getItem('margin_num') || 50;
document.getElementById("margin").addEventListener("input",() =>  {
  localStorage.setItem('margin_num', margin.value);
  calculate();});

document.getElementById('screens').innerHTML = localStorage.getItem('screen_num') || 5;
document.getElementById('days').innerHTML = localStorage.getItem('day_num') || 5; 
document.getElementById('hours').innerHTML = localStorage.getItem('hour_num') || 12;
document.getElementById('capex_tot').innerHTML = '$ '+ parseFloat(localStorage.getItem('capex_tot')).toFixed(2);
document.getElementById('monthly_tot').innerHTML = '$ '+ parseFloat(localStorage.getItem('monthly_tot')).toFixed(2);
document.getElementById('ele_tot').innerHTML = '$ '+ parseFloat(localStorage.getItem('ele_tot')).toFixed(2);
document.getElementById('period').innerHTML = parseFloat(localStorage.getItem('life_num')).toFixed(0);

function calculate() {
  let weeklyTrans = (revenue.value / avgchk.value) / 52;
  let monthlyTrans = (revenue.value / avgchk.value) / 12;
  let totalTrans = (revenue.value / avgchk.value) * ((months.value) / 12); 
  let annualTrans = (revenue.value / avgchk.value); 
  let requiredLiftD =  (((annualSalesMth/((margin.value)/100))/totalTrans )); 
  let requiredLiftP =  requiredLiftD / avgchk.value;
  if(revenue.value  == "0" || avgchk.value == "0"){ weeklyTrans=monthlyTrans=annualTrans=requiredLiftD=requiredLiftP = 0;}
  document.getElementById("weekly").innerHTML = weeklyTrans.toFixed(0);
  document.getElementById("monthly").innerHTML = monthlyTrans.toFixed(0);
  document.getElementById("totalTrans").innerHTML = totalTrans.toFixed(0);
  document.getElementById("checkD").innerHTML = '$ ' + requiredLiftD.toFixed(4);
  document.getElementById("checkP").innerHTML = requiredLiftP.toFixed(4) + ' %';
  let profit = ((((requiredLiftD*((margin.value)/100))*annualTrans))*((lifeSpanMth-(months.value)/12)))-((annualElec+annualOper)*((lifeSpanMth-(months.value)/12)));
  document.getElementById("profit").innerHTML = '$ ' + profit.toFixed(0);
}
</script>
</body>
</html>

